# DCSv10 – Decompression Sickness (DCS) Risk Prediction Model

## Overview
`DCSv10.py` is a self-contained Python pipeline that trains an ensemble Gradient-Boosting model to predict the **Risk of Decompression Sickness (DCS)** for high-altitude exposures.  
The model is trained on **`DCS_Risk_DB_2025.csv`**, a data set derived from the **Altitude Decompression Sickness Risk Assessment Computer (ADRAC)** model developed by the U.S. Air Force Research Laboratory (AFRL).  
All outputs (predictions, trained models, scalers, encoders) are saved to `Model_Rel_Candidate/output/`.

## Data Source
| Variable | Unit | Description |
|----------|------|-------------|
| `altitude` | ft | Peak cabin / chamber altitude |
| `prebreathing_time` | min | Minutes of 100 % O₂ pre-breathing prior to ascent |
| `exercise_level` | {Rest, Mild, Heavy} | Level of metabolic activity during exposure |
| `risk_of_decompression_sickness` | % | Reference DCS risk computed with ADRAC |

The CSV was generated by querying ADRAC under an academic license.  **No proprietary ADRAC code is shipped in this repo—only the numerical outputs.**

## Repository Structure
```
Model_Rel_Candidate/
 ├─ DCSv10.py           # Training & inference script (this project)
 ├─ DCS_Risk_DB_2025.csv# ADRAC-derived data set
 ├─ Metrics.txt         # Historical metrics from a previous run
 ├─ output/             # Auto-generated results
 │   ├─ DCS_predictions_<timestamp>.csv
 │   └─ …
 └─ README.md           # (this file)
```

## Installation
```bash
# Clone repository (or copy folder)
cd Model_Rel_Candidate

# Create environment (conda example)
conda create -n dcs python=3.9 -y
conda activate dcs

# Install dependencies
pip install -r ../requirements.txt  # or install manually
```

## Running the Model
```bash
# From inside Model_Rel_Candidate (or any folder)
python DCSv10.py
```
The script will:
1. Load `DCS_Risk_DB_2025.csv` using a path **relative to the script location**.
2. One-hot encode `exercise_level` and standard-scale numerical columns.
3. Perform an exhaustive `GridSearchCV` to tune a `GradientBoostingRegressor`.
4. Train an **ensemble of 100 models** with the best hyper-parameters.
5. Evaluate performance on a 20 % hold-out set and print metrics (R², MSE, RMSE, MAE).
6. Compute a 95 % prediction interval from the ensemble spread.
7. Save predictions and model artifacts into `output/` using a time-stamped prefix.

### Example Output
```
Model Performance Metrics (Ensemble on Test Set)
----------------------------------------------
R-squared (Ensemble): 0.9470
Mean Squared Error : 20.1234
Root Mean Squared Error: 4.4869
Mean Absolute Error : 4.2247
```

## Re-Training with New Data
1. Add new rows to `DCS_Risk_DB_2025.csv` following the same schema.
2. Re-run `python DCSv10.py`.  The script automatically retrains and produces fresh artifacts.

## Theory & Methodology
The ADRAC model combines **bubble-growth physics** with a **log-logistic statistical framework** to predict the probability of symptomatic DCS during hypobaric exposure.  We treat ADRAC's outputs as authoritative ground-truth labels and train a machine-learning surrogate to reproduce them quickly (milliseconds vs. seconds).  
This approach retains ADRAC's fidelity while enabling integration into Monte-Carlo simulations, rapid UX tools, or real-time displays where Python is available.

### Features and Pre-processing
* **Altitude (ft)** – continuous, scaled via `StandardScaler`  
* **Pre-breathing time (min)** – continuous, scaled  
* **Exercise level** – categorical, one-hot encoded (Rest, Mild, Heavy)

### Model
* **Base learner:** `GradientBoostingRegressor` (sklearn)  
* **Hyper-parameters tuned:** `n_estimators`, `learning_rate`, `max_depth`, `min_samples_split`, `min_samples_leaf`, `subsample`, `max_features`  
* **Ensemble:** 100 independent models (different `random_state`) averaged for prediction & uncertainty estimation.

## Validation Metrics (January 2025 run)
Values from `Metrics.txt`:
* **R²:** 0.9470  
* **MAE:** 4.22 percentage-points  
* **RMSE:** 4.49 percentage-points  
These indicate close reproduction of ADRAC outputs across the operational envelope.

## Limitations & Disclaimer
* The surrogate is only as valid as the ADRAC data it was trained on; extrapolation beyond those bounds is not advised.
* This repository **does not** provide ADRAC source code—only derived data consistent with AFRL academic license terms.
* Use of ADRAC name or outputs must acknowledge AFRL and comply with any license restrictions.

## References
* Pilmanis, A.A., Petropoulos, L., & Kannan, N. **"Altitude Decompression Sickness Risk Assessment Computer (ADRAC) Development."** DTIC ADA397485, 1999. [[PDF]](https://apps.dtic.mil/sti/citations/ADA397485)
* Petropoulos, L. **"Altitude Decompression Sickness Risk Prediction Research."** Presented at RTO HFM Symposium, Toronto, 2000. [[PDF]](https://apps.dtic.mil/sti/tr/pdf/ADP011090.pdf)
* U.S. Air Force Research Laboratory. **"Risk Model for High-Altitude Missions Added to NATOPS."** 2010. [[Article]](https://www.wpafb.af.mil/News/Article-Display/Article/400140/risk-model-for-high-altitude-missions-added-to-natops/)
* Pilmanis, A.A. et al. **"Decompression sickness risk model: Development and validation by 150 prospective hypobaric exposures."** Aerospace Medicine & Human Performance (ResearchGate preprint). [[Link]](https://www.researchgate.net/publication/8254212_Decompression_sickness_risk_model_Development_and_validation_by_150_prospective_hypobaric_exposures)
* PubMed ID 33754970. **"Decompression Sickness Risk Assessment and Awareness in General Aviation Pilots."** Utilises ADRAC risk estimates. [[PubMed]](https://pubmed.ncbi.nlm.nih.gov/33754970/)

> The above links were obtained via web search ([DTIC PDF] and related pages). 